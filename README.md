# projeto Cep

## Descrição:

Este projeto gerou do código Node.JS um serviço de BackEnd, implementa o formato de CEP no site do ViaCep. Verifica realiza de um fonte-código
o número do cep sucesso e errado executa passando em testes unitário e integração e o fluxo de trabalho é conjunto de ação automatizada. Está configurado uma pipeline de CI/CD no GitHub Actions.

## Configuração do Projeto

### 1. Criar nova pasta

```bash
C:\Projeto_Cep
```

### 2. Inicia do novo projeto no arquivo pacote json

```bash
npm init -y
```

### 3. Instale a dependência

```bash
npm install axios
```

### 4. Instale a devDependencie

```bash
npm install --save-dev jest
```

### 5. Implementar o código utiliza node.js

#### Arquivo: `src/cep.js`

```javascript
const axios = require("axios");

const Validar_CEP = (cep) => {
  const myRe = /^[0-9]{5}-[0-9]{3}$/;
  return myRe.test(cep);
};

const getEnderecoCep = async (cep) => {
  if (!Validar_CEP(cep)) {
    throw new Error("Inválido CEP!");
  }
  const responde = await axios.get(`https://viacep.com.br/ws/${cep}/json/`);
  return responde.data;
};

module.exports = { Validar_CEP, getEnderecoCep };
```

## Escrita dos Testes Automatizados

### Testes Unitário:

#### Arquivo: `tests/unidade.test.js`

```javascript
const { Validar_CEP } = require("../src/cep");

describe("Teste entre válido e inválido do CEP", () => {
  test("Válido CEP", () => {
    expect(Validar_CEP("31515-220")).toBe(true);
  });

  test("Inválido CEP", () => {
    expect(Validar_CEP("")).toBe(false);
  });
});
```

### Testes de Integração:

#### Arquivo: `tests/integracao.test.js`

```javascript
const { getEnderecoCep } = require("../src/cep");

describe("Teste o número do CEP", () => {
  test("Válida CEP", async () => {
    const data = await getEnderecoCep("31515-220");
    expect(data).toHaveProperty("cep", "31515-220");
    expect(data).toHaveProperty("logradouro", "Rua José Sanguinete");
    expect(data).toHaveProperty("complemento", "");
    expect(data).toHaveProperty("bairro", "São João Batista (Venda Nova)");
    expect(data).toHaveProperty("localidade", "Belo Horizonte");
    expect(data).toHaveProperty("uf", "MG");
    expect(data).toHaveProperty("ibge", "3106200");
    expect(data).toHaveProperty("ddd", "31");
  });

  test("CEP inválido", async () => {
    await expect(getEnderecoCep("31515220")).rejects.toThrow("Inválido");
  });
});
```

### Inicialize este repositório com:

Adicione `.gitignore` colocar NODE do repositório, comando git pull origin main o para diretório de código.

#### Arquivo `.gitignore`

```bash
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*
.pnpm-debug.log*

# Diagnostic reports (https://nodejs.org/api/report.html)
report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json

# Runtime data
pids
*.pid
*.seed
*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage
*.lcov

# nyc test coverage
.nyc_output

# Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# Bower dependency directory (https://bower.io/)
bower_components

# node-waf configuration
.lock-wscript

# Compiled binary addons (https://nodejs.org/api/addons.html)
build/Release

# Dependency directories
node_modules/
jspm_packages/

# Snowpack dependency directory (https://snowpack.dev/)
web_modules/

# TypeScript cache
*.tsbuildinfo

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache

# Optional stylelint cache
.stylelintcache

# Microbundle cache
.rpt2_cache/
.rts2_cache_cjs/
.rts2_cache_es/
.rts2_cache_umd/

# Optional REPL history
.node_repl_history

# Output of 'npm pack'
*.tgz

# Yarn Integrity file
.yarn-integrity

# dotenv environment variable files
.env
.env.development.local
.env.test.local
.env.production.local
.env.local

# parcel-bundler cache (https://parceljs.org/)
.cache
.parcel-cache

# Next.js build output
.next
out

# Nuxt.js build / generate output
.nuxt
dist

# Gatsby files
.cache/
# Comment in the public line in if your project uses Gatsby and not Next.js
# https://nextjs.org/blog/next-9-1#public-directory-support
# public

# vuepress build output
.vuepress/dist

# vuepress v2.x temp and cache directory
.temp
.cache

# Docusaurus cache and generated files
.docusaurus

# Serverless directories
.serverless/

# FuseBox cache
.fusebox/

# DynamoDB Local files
.dynamodb/

# TernJS port file
.tern-port

# Stores VSCode versions used for testing VSCode extensions
.vscode-test

# yarn v2
.yarn/cache
.yarn/unplugged
.yarn/build-state.yml
.yarn/install-state.gz
.pnp.*
```

### Comando Git

```bash
git init
git remote add https://github.com/kelleao/projetoCICD_Endereco_Cep.git
git pull origin main
git add .
git commit -m "Alterar o projeto"
git push origin master

```

### Configuração do GitHub Actions

#### Arquivo: `.github/workflows/cicd.yml`

```yaml
name: CI

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      - name: Use Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20.13.1"
      - name: Install dependencies
        run: npm install
      - name: Tests unidade
        run: npm test tests/unidade.test.js
      - name: Tests integracao
        run: npm test tests/integracao.test.js`
```

### Como Funciona a Pipeline de CI/CD

A pipeline de integração contiuna é a configurada, passar executado e comando push para o branch direto para GitHub. O fluxo de trabalho como implementa

1. Usar checkout,
2. Configurar o node na versão 20.13.1,
3. Instalar a despendencia,
4. Executar o teste unidad,
5. Executar o teste interagração.

### Referências

- [Jest] https://jestjs.io/pt-BR/docs/getting-started
- [GitHubActions]https://docs.github.com/pt/actions/automating-builds-and-tests/building-and-testing-nodejs
- [ViaCEP]https://viacep.com.br/
- [Node.js]https://nodejs.org/en
